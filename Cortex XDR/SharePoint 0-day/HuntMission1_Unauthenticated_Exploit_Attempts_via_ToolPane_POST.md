# Detection of Unauthenticated Exploit Attempts via ToolPane.aspx POST (CVE-2025-53770/53771)

## Severity or Impact of the Detected Behavior
- **Risk Score:** 85
- **Severity:** High

## Hunt Analytics Metadata

- **ID:** HuntQuery-SharePoint-ToolPane-POST-CVE2025-53770
- **Operating Systems:** WindowsServer, SharePoint
- **False Positive Rate:** Low

---

## Hunt Analytics

This hunt detects unauthenticated exploit attempts against Microsoft SharePoint by identifying suspicious POST requests to `/ _layouts/15/ToolPane.aspx` or `/ _layouts/16/ToolPane.aspx` with the HTTP Referer set to `/ _layouts/SignOut.aspx`. This pattern is a key indicator of the unauthenticated exploit chain for CVE-2025-53770 and CVE-2025-53771, as observed in recent threat intelligence reporting. Attackers leverage this sequence to bypass authentication and gain unauthorized access or execute code on vulnerable SharePoint servers.

Detected behaviors include:

- POST requests to ToolPane.aspx endpoints without prior authentication
- HTTP Referer header set to SignOut.aspx, indicating session manipulation or forced sign-out as part of the exploit chain
- Unusual or suspicious user agents

These techniques are associated with initial access and exploitation of public-facing applications.

---

## ATT&CK Mapping

| Tactic                        | Technique   | Subtechnique | Technique Name                                 |
|------------------------------|-------------|--------------|-----------------------------------------------|
| TA0001 - Initial Access       | T1190       | —            | Exploit Public-Facing Application             |
| TA0011 - Command and Control | T1071.001   | —            | Application Layer Protocol: Web Protocols      |

---

## Hunt Query Logic

This query identifies unauthenticated exploit attempts by looking for:

- Network events with POST requests to `/ _layouts/15/ToolPane.aspx` or `/ _layouts/16/ToolPane.aspx`
- HTTP Referer header containing `/ _layouts/SignOut.aspx`
- Filtering for relevant fields such as timestamp, hostname, URL, method, referer, and user agent

These patterns are indicative of attempts to exploit SharePoint via the unauthenticated ToolPane.aspx POST method.

---

## Hunt Query Syntax

**Query Language:** XQL (Cortex Query Language)  
**Platform:** Palo Alto Cortex XSIAM

```xql
// Title: Detection of Unauthenticated Exploit Attempts via ToolPane.aspx POST (CVE-2025-53770/53771)
// Description: Detects suspicious POST requests to ToolPane.aspx with Referer set to SignOut.aspx, indicative of unauthenticated SharePoint exploit attempts.
// MITRE ATT&CK TTP IDs: T1190, T1071.001

dataset = xdr_data   
| filter event_type = ENUM.NETWORK  
| filter dst_action_url contains "/_layouts/15/ToolPane.aspx" or dst_action_url contains "/_layouts/16/ToolPane.aspx"   
| filter http_method = "POST"   
| filter http_referer contains "/_layouts/SignOut.aspx"   
| fields event_timestamp, agent_hostname , dst_action_url, http_method, http_referer, action_user_agent  
```

---

## Data Sources

| Log Provider   | Event Name   | ATT&CK Data Source | ATT&CK Data Component |
|---------------|--------------|--------------------|-----------------------|
| Cortex XSIAM  | xdr_data     | Network Traffic    | Web Request           |

---

## Execution Requirements

- **Required Permissions:** Ability to collect and analyze network traffic logs from SharePoint servers.
- **Required Artifacts:** Network event logs, HTTP request metadata (method, URL, referer, user agent).

---

## Considerations

- Review the source IP and user agent for known threat actor infrastructure or automated tools.
- Correlate with authentication logs to confirm lack of valid session prior to POST request.
- Investigate any follow-on activity from the same source, such as lateral movement or privilege escalation.
- Validate if the SharePoint instance is patched for CVE-2025-53770/53771.

---

## False Positives

False positives are unlikely but may occur if:

- Legitimate automated tools or scripts interact with ToolPane.aspx in a non-standard way.
- Custom integrations or monitoring solutions trigger similar POST requests during sign-out workflows.

---

## Recommended Response Actions

1. Investigate the source and intent of the POST request.
2. Review SharePoint server logs for signs of exploitation or unauthorized changes.
3. Isolate affected servers if compromise is suspected.
4. Apply security patches for CVE-2025-53770/53771 immediately.
5. Monitor for additional suspicious activity from the same source.

---

## References

- [MITRE ATT&CK: T1190 – Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190/)
- [MITRE ATT&CK: T1071.001 – Application Layer Protocol: Web Protocols](https://attack.mitre.org/techniques/T1071/001/)
- [Microsoft Security Blog: Disrupting Active Exploitation of On-Premises SharePoint Vulnerabilities (July 22, 2025)](https://www.microsoft.com/en-us/security/blog/2025/07/22/disrupting-active-exploitation-of-on-premises-sharepoint-vulnerabilities/)
- [Unit 42: Microsoft SharePoint CVE-2025-49704, CVE-2025-49706, CVE-2025-53770 Analysis](https://unit42.paloaltonetworks.com/microsoft-sharepoint-cve-2025-49704-cve-2025-49706-cve-2025-53770/)
- [Eye Security: SharePoint Under Siege](https://research.eye.security/sharepoint-under-siege/)
---

## Version History

| Version | Date       | Impact            | Notes                                                                                      |
|---------|------------|-------------------|--------------------------------------------------------------------------------------------|
| 1.0     | 2025-07-21 | Initial Detection | Created hunt query to detect unauthenticated SharePoint ToolPane.aspx POST exploit attempts |
